!function r(i,a,l){function n(t,e){if(!a[t]){if(!i[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(p)return p(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}o=a[t]={exports:{}},i[t][0].call(o.exports,function(e){return n(i[t][1][e]||e)},o,o.exports,r,i,a,l)}return a[t].exports}for(var p="function"==typeof require&&require,e=0;e<l.length;e++)n(l[e]);return n}({1:[function(e,t,o){"use strict";e("./prmBriefResultAfter/kohaItemsAvailability"),e("./prmOpacAfter/kohaItemsTable");e=angular.module("viewCustom",["angularLoad","kohaItemsAvailability","kohaItemsTable"]);e.config(["$sceDelegateProvider",function(e){var t=e.resourceUrlWhitelist();t.push("http://catalogue.unice.fr:1701**","http://catalogue.unice.fr**","https://demo.biblibre.com**","https://pro-bu-cotedazur-koha.preprod.biblibre.eu**","https://catalogue-bu-cotedazur-koha.preprod.biblibre.eu**","https://api.archives-ouvertes.fr**","https://books.google.com**","http://books.google.com**","https://bu.univ-cotedazur.fr**","http://localhost:8003**","https://localhost:5000**","http://dev-scd.unice.fr**","https://api-scd.univ-cotedazur.fr**"),e.resourceUrlWhitelist(t)}]),e.constant("URLs",{_UCA_CAS:"https://login.unice.fr/login?service=",_koha_prod:"https://catalogue-bu-univ-cotedazur.biblibre.fr",_koha_preprod:"https://catalogue-bu-cotedazur-koha.preprod.biblibre.eu",_testbiblibre_koha_api_public:"https://demo.biblibre.com/api/v1/public/",_testbiblibre_koha_api_privee:"https://demo.biblibre.com/api/v1/",_preprod_koha_api_public:"https://catalogue-bu-cotedazur-koha.preprod.biblibre.eu/api/v1/public/",_preprod_koha_api_privee:"https://catalogue-bu-cotedazur-koha.preprod.biblibre.eu/api/v1/",_local_koha_primo_middleware:"https://localhost:5000/koha-primo-middleware/api/v1/koha/",_devscd_koha_primo_middleware:"http://dev-scd.unice.fr/koha-primo-middleware/api/v1/koha/",_prodscd_koha_primo_middleware:"https://api-scd.univ-cotedazur.fr/koha-primo-middleware/api/v1/koha/"}),e.component("prmTopBarBefore",{bindings:{parentCtrl:"<"},controller:[function(){this.$onInit=function(){var e=document.getElementsByTagName("head")[0],t=document.createElement("script");t.type="text/javascript",t.src="https://code.jquery.com/jquery-3.6.3.min.js",e.appendChild(t)}}]}),e.component("prmExploreMainAfter",{templateUrl:"custom/UCA/html/matomo.html"}),e.run(["$templateCache",function(e){e.put("components/search/fullView/getit/opac/locations/locations.html","<prm-uca-items-table-koha></prm-uca-items-table-koha>")}])},{"./prmBriefResultAfter/kohaItemsAvailability":2,"./prmOpacAfter/kohaItemsTable":3}],2:[function(e,t,o){"use strict";angular.module("kohaItemsAvailability",[]).controller("kohaItemsAvailabilityController",["$scope","$http","$element","URLs",function(a,l,n,p){this.$onInit=function(){var t,e,o,r,i;a.$ctrl.parentCtrl.item&&(a.kohaDisplay=!1,i=a.$ctrl.parentCtrl.item.pnx,t=i.display.type[0],e=i.facets.toplevel[0],o=i.control.sourceid[0],r=i.control.sourcerecordid[0],o.includes("_KOHA"))&&"online_resources"!=e&&(i=p._prodscd_koha_primo_middleware+"biblios_items/"+r,l({headers:{"Content-Type":"application/json","X-From-ExL-API-Gateway":void 0},method:"GET",url:i,cache:!0}).then(function(e){a.kohaDisplay=!0,n.parent().parent().children()[3].style.display="none",a.items=e.data,a.record_type=t,a.biblio_id=r}).catch(function(e){for(var t=angular.element(document.querySelectorAll(".search-result-availability-line-wrapper")),o=0,r=t.length;o<r;o++)t[o].style.display="block";for(o=0,r=(t=angular.element(document.querySelectorAll("prm-brief-result-container prm-search-result-availability-line>*:not(:nth-last-child(1))"))).length;o<r;o++)t[o].style.display="block"}))}}]).component("prmBriefResultAfter",{bindings:{parentCtrl:"<"},controller:"kohaItemsAvailabilityController",templateUrl:"custom/UCA/html/prmBriefResultAfter.html"})},{}],3:[function(e,t,o){"use strict";angular.module("kohaItemsTable",[]).controller("kohaItemsTableController",["$scope","$rootScope","$http","URLs",function(a,l,n,p){this.$onInit=function(){var o,e,t,r,i;a.$ctrl.parentCtrl.item&&((i=this).scope=a,i.rootScope=l,i=i.rootScope.$$childHead.$ctrl.userSessionManagerService,console.log(i),a.userIsGuest=i.isGuest(),i=a.$ctrl.parentCtrl.item.pnx,o=i.display.type[0],e=i.facets.toplevel[0],t=i.control.sourceid[0],r=i.control.sourcerecordid[0],t.includes("_KOHA"))&&"online_resources"!=e&&(i=p._prodscd_koha_primo_middleware+"biblios_items/"+r,n({headers:{"Content-Type":"application/json","X-From-ExL-API-Gateway":void 0},method:"GET",url:i,cache:!0}).then(function(e){console.log(e.data),a.items=e.data,a.record_type=o,a.biblio_id=r;var t=p._UCA_CAS+p._koha_prod+"/cgi-bin/koha/opac-reserve.pl?biblionumber="+r;a.open=function(){return window.open(t,"_system"),!1}}))}}]).component("prmOpacAfter",{bindings:{parentCtrl:"<"},controller:"kohaItemsTableController",templateUrl:"custom/UCA/html/prmOpacAfter.html"})},{}]},{},[1]);
//# sourceMappingURL=custom.js.map
