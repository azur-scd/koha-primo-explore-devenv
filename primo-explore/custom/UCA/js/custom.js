!function a(o,i,n){function l(t,e){if(!i[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(s)return s(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=i[t]={exports:{}},o[t][0].call(r.exports,function(e){return l(o[t][1][e]||e)},r,r.exports,a,o,i,n)}return i[t].exports}for(var s="function"==typeof require&&require,e=0;e<n.length;e++)l(n[e]);return l}({1:[function(e,t,r){"use strict";angular.module("kohaServices",[]).factory("kohaItemDataService",["$http","$q","KOHA_MIDDLEWARE_URL",function(t,e,r){return{kohaData:function(e){e=r._api+"biblios_items?biblio_ids="+e;return t({headers:{"Content-Type":"application/json","X-From-ExL-API-Gateway":void 0},method:"GET",url:e,cache:!0}).then(function(e){return e.data})}}}])},{}],2:[function(e,t,r){"use strict";angular.module("shareDataService",[]).factory("pnxShareDataService",[function(){return{pnxData:function(e){var t=e.display.type[0],r=e.facets.toplevel,a=e.control.sourceid,e=e.control.sourcerecordid[0];if(a.some(function(e){return e.includes("_KOHA")})&&r.includes("available"))return{type:t,koha_ids:1<a.length?a.filter(function(e){return e.includes("_KOHA")}).map(function(e){return e.split("$$O33UCA_KOHA")[1]}).toString():e}}}}])},{}],3:[function(e,t,r){"use strict";e("./prmBriefResultAfter/kohaItemsAvailability"),e("./prmOpacAfter/kohaItemsTable");e=angular.module("viewCustom",["angularLoad","kohaItemsAvailability","kohaItemsTable"]);e.config(["$sceDelegateProvider",function(e){var t=e.resourceUrlWhitelist();t.push("http://catalogue.unice.fr:1701**","http://catalogue.unice.fr**","https://demo.biblibre.com**","https://pro-bu-cotedazur-koha.preprod.biblibre.eu**","https://catalogue-bu-cotedazur-koha.preprod.biblibre.eu**","https://api.archives-ouvertes.fr**","https://books.google.com**","http://books.google.com**","https://bu.univ-cotedazur.fr**","http://localhost:8003**","https://localhost:5000**","http://dev-scd.unice.fr**","https://api-scd.univ-cotedazur.fr**"),e.resourceUrlWhitelist(t)}]),e.constant("URLs",{_UCA_CAS:"https://login.unice.fr/login?service=",_local_koha_primo_middleware:"https://localhost:5000/koha-primo-middleware/api/v1/koha/",_devscd_koha_primo_middleware:"http://dev-scd.unice.fr/koha-primo-middleware/api/v0/koha/",_prodscd_koha_primo_middleware:"https://api-scd.univ-cotedazur.fr/koha-primo-middleware/api/v1/koha/"}),e.provider("KOHA_MIDDLEWARE_URL",["URLs",function(e){this.$get=function(){return{_api:e._local_koha_primo_middleware}}}]),e.component("prmTopBarBefore",{bindings:{parentCtrl:"<"},controller:[function(){this.$onInit=function(){var e=document.getElementsByTagName("head")[0],t=document.createElement("script");t.type="text/javascript",t.src="https://code.jquery.com/jquery-3.6.3.min.js",e.appendChild(t)}}]}),e.component("prmExploreMainAfter",{bindings:{parentCtrl:"<"},templateUrl:"custom/UCA/html/matomo.html"}),e.component("prmSearchBarAfter",{bindings:{parentCtrl:"<"},template:'<div class="bar custom-alert-bar layout-align-center-center layout-row" layout="row" layout-align="center center"><b>Vacances d\'été</b> : la <span style="margin-left:5px;margin-right:5px;">navette interBU</span> est interrompue du 21 juillet au 21 août. <a href="https://bu.univ-cotedazur.fr/fr/contents/actualites/fermeture-estivale-des-bu-et-des-services" target="_blanck"> En savoir plus</a></div>'})},{"./prmBriefResultAfter/kohaItemsAvailability":4,"./prmOpacAfter/kohaItemsTable":5}],4:[function(e,t,r){"use strict";e("../customServices/kohaServices"),e("../customServices/shareDataService");angular.module("kohaItemsAvailability",["kohaServices","shareDataService"]).controller("kohaItemsAvailabilityController",["$scope","kohaItemDataService","pnxShareDataService",function(o,t,r){this.$onInit=function(){var e,a;o.$ctrl.parentCtrl.item&&(o.kohaDisplay=!1,e=o.$ctrl.parentCtrl.item.pnx,console.log(e),(a=r.pnxData(e))?t.kohaData(a.koha_ids).then(function(e){o.items=e.items,o.kohaDisplay=!0;var t=angular.element(document.querySelectorAll("div.search-result-availability-line-wrapper > prm-search-result-availability-line > div.layout-align-start-start > div.layout-row"));length=t.length;for(var r=0;r<length;r++)t[r].querySelector('prm-icon[ng-if*="$ctrl.isPhysical"]')&&(t[r].style.display="none");o.record_type=a.type}):o.kohaDisplay=!1)}}]).component("prmBriefResultAfter",{bindings:{parentCtrl:"<"},controller:"kohaItemsAvailabilityController",templateUrl:"custom/UCA/html/prmBriefResultAfter.html"})},{"../customServices/kohaServices":1,"../customServices/shareDataService":2}],5:[function(e,t,r){"use strict";e("../customServices/kohaServices"),e("../customServices/shareDataService");angular.module("kohaItemsTable",["kohaServices","shareDataService"]).controller("kohaItemsTableController",["$scope","$rootScope","URLs","kohaItemDataService","pnxShareDataService",function(a,t,o,i,n){this.$onInit=function(){var e,r;a.$ctrl.parentCtrl.item&&(a.kohaTableDisplay=!1,this.scope=a,this.rootScope=t,e=this.rootScope.$$childHead.$ctrl.userSessionManagerService,a.userIsGuest=e.isGuest(),console.log(a),e=a.$ctrl.parentCtrl.item.pnx,(r=n.pnxData(e))?i.kohaData(r.koha_ids).then(function(e){a.items=e.items,a.biblio_id=a.items[0].biblio_id,a.resa=e.resa_button,a.kohaTableDisplay=!0,angular.element(document.querySelector("prm-opac>md-tabs"))[0].style.display="none",a.record_type=r.type;var t=o._UCA_CAS+o._koha_prod+"/cgi-bin/koha/opac-reserve.pl?biblionumber="+a.biblio_id;a.open=function(){return window.open(t,"_system"),!1}}):a.kohaTableDisplay=!1)}}]).component("prmOpacAfter",{bindings:{parentCtrl:"<"},controller:"kohaItemsTableController",templateUrl:"custom/UCA/html/prmOpacAfter.html"})},{"../customServices/kohaServices":1,"../customServices/shareDataService":2}]},{},[3]);
//# sourceMappingURL=custom.js.map
